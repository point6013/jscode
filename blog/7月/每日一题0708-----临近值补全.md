<!--
 * @Author: Huang Meng
 * @Date: 2021-07-27 19:03:03
 * @LastEditTime: 2021-07-27 19:05:39
 * @LastEditors: your name
 * @Description: 
 * @FilePath: \01code\blog\每日一题0708-----临近值补全.md
 * 可以输入预定的版权声明、个性签名、空行等
-->


![image](https://tvax3.sinaimg.cn/mw690/9ebd4c2bgy1gsvpo1lbwnj20nq0ixdms.jpg)

#### 测试数据


```sql

CREATE TABLE T0708 
(LDate DATE NOT NULL,
Value1 INT NULL,
Value2 INT NULL
)
INSERT INTO T0708 VALUES('2020-11-25', 500 ,200);
INSERT INTO T0708 VALUES('2020-11-24', Null, 200);
INSERT INTO T0708 VALUES('2020-11-23', Null, 250);
INSERT INTO T0708 VALUES('2020-11-22', 300 ,Null);
INSERT INTO T0708 VALUES('2020-11-21', 200 ,320)
```

- solution1


```sql
SELECT 
T1.LDATE,
CASE 
	WHEN VALUE1 IS NULL THEN (SELECT  VALUE1 FROM T0708 T2 WHERE T2.LDATE < T1.LDATE AND VALUE1 IS NOT NULL ORDER BY LDATE DESC limit 1 )
	ELSE VALUE1
END AS VALUE1,
CASE 
	WHEN VALUE2 IS NULL THEN (SELECT  VALUE2 FROM T0708 T2 WHERE T2.LDATE < T1.LDATE AND VALUE2 IS NOT NULL ORDER BY LDATE DESC limit 1)
	ELSE VALUE2
END AS VALUE2
FROM T0708 T1


```