select 
-- bud_category,
-- `year`,
sum(proj_cur_ver) Total_Projection,
sum(purchase_total) Purchase_Plan,
sum(pd_total)-sum(act_payment) PD_Not_Paid,
sum(act_payment)Pament
from app1_apply_info_to_be  a
where bud_category is not null
and prod_name <>"noPD"
and year = year(get_

;
-- group by 1,2



select 
bud_category,
`year`,
sum(proj_cur_ver) Total_Projection,
sum(purchase_total) Purchase_Plan,
sum(pd_total)-sum(act_payment) PD_Not_Paid,
sum(act_payment)Pament
from app1_apply_info_to_be  a
where bud_category is not null
and prod_name <>"noPD"
group by 1,2;




select 
it_bp_desc,
`year`,
sum(proj_cur_ver) Total_Projection,
sum(purchase_total) Purchase_Plan,
sum(pd_total)-sum(act_payment) PD_Not_Paid,
sum(act_payment)Pament
from app1_apply_info_to_be  a
where bud_category is not null
and prod_name <>"noPD"
group by 1,2;





select 
biz_owner_name,
`year`,
sum(proj_cur_ver) Total_Projection,
sum(purchase_total) Purchase_Plan,
sum(pd_total)-sum(act_payment) PD_Not_Paid,
sum(act_payment)Pament
from app1_apply_info_to_be  a
where bud_category is not null
and prod_name <>"noPD"
group by 1,2;
